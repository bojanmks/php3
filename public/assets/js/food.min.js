$(document).ready(()=>{async function e(a=1){var b=$("#idRestaurant").val(),c=$("#tbName").val().trim();const d=$("#ddlSort").val();let h=[];for(let l of $(".food-category.active"))h.push($(l).data("id"));$(".loader").fadeIn("fast");a=await ajaxCallback(base_url+"/restaurants/food","POST",{id:b,keyword:c,sortOrder:d,categories:h,page:a});$(".loader").fadeOut("fast");if(a.views.length){b="";for(var f of a.views)b+=f;$("#foodWrapper").html(b)}else $("#foodWrapper").html("<span class='no-results col-12 font-medium'>No food matches your search criteria.</span>");
f=a.food.current_page;a=a.food.last_page;b=`<ul class='pagination font-small'><li class='page-item ${1===f?"disabled":""}'><a href='#' class='page-link pagination-back'><i class='fas fa-caret-left'></i></a></li>`;for(c=0;c<a;c++)b+=`<li class="page-item ${c+1===f?"active":""}"><a href='#' class="page-link" data-page='${c+1}'>${c+1}</a></li>`;b+=`<li class='page-item ${f===a?"disabled":""}'><a href='#' class='page-link pagination-next'><i class='fas fa-caret-right'></i></a></li></ul>`;$("#foodPagination").html(b);
m();n()}function m(){$(".pagination a").click(function(a){a.preventDefault()});$(".page-link").click(function(){const a=$(".page-item.active .page-link").data("page"),b=$(this).data("page");b!==a&&e(b)});$(".pagination-back").click(function(){const a=$(".page-item.active .page-link").data("page");1>=a||e(a-1)});$(".pagination-next").click(function(){const a=$(".page-item.active .page-link").data("page"),b=$(".page-link").length;a>=b||e(a+1)})}function n(){$(".add-food").on("click",async function(a){a.preventDefault();
a=$(this).data("id");await ajaxCallback(base_url+"/cart/add","POST",{id:a})&&g()})}async function g(){var a=window.location.href.split("/");a=parseInt(a[a.length-1]);a=await ajaxCallback(base_url+"/cart/items","POST",{restaurantId:a});let b="",c=0;if(a.length){for(let d of a)c+=parseFloat(d.price)*parseInt(d.amount),b+=`<li class="order-item font-small row d-flex align-items-center justify-content-between">
                        <span class="col-8">${d.name} - <span class="fw-bold">$${d.price}</span></span>
                        <span class="col-4 d-flex justify-content-end font-small">
                            <a href="#" data-id="${d.cart_id}" data-action="decrease" class="btn-amount btn-decrease color-primary"><i class="fas fa-minus"></i></a>
                            <span class="mx-1">${d.amount}</span>
                            <a href="#" data-id="${d.cart_id}" data-action="increase" class="btn-amount btn-increase color-primary"><i class="fas fa-plus"></i></a>
                            <a href="#" data-id="${d.cart_id}" data-action="remove" class="ms-3 btn-amount btn-remove"><i class="fa fa-times" aria-hidden="true"></i></a>
                        </span>
                        </li>`;b+=`<li class="font-small d-flex align-items-center justify-content-between mt-2"><span>Total:</span><span class="fw-bold">$${c.toFixed(2)}</span></li>`}else b='<li class="font-small text-center">Your order is empty</li>';$("#orderItems ul").html(b);p()}function p(){$(".btn-amount").click(async function(a){a.preventDefault();a=$(this).data("id");const b=$(this).data("action");await ajaxCallback(base_url+"/cart/change","POST",{id:a,action:b})&&g()})}function k(){validateField($("#address"),
q)}e();g();$("#allCategories").click(function(a){a.preventDefault();$(".food-category").removeClass("active");$(this).addClass("active");e()});$(".food-category").click(function(a){a.preventDefault();$("#allCategories").removeClass("active");$(this).hasClass("active")?($(this).removeClass("active"),$(".food-category.active").length||$("#allCategories").addClass("active")):$(this).addClass("active");e()});$("#tbName").on("input",()=>{e()});$("#ddlSort").on("change",()=>{e()});const q=/^[A-Z\u0160\u0110\u010c\u0106\u017d][a-z\u0161\u0111\u010d\u0107\u017e]{2,}(\s[A-Z\u0160\u0110\u010c\u0106\u017da-z\u0161\u0111\u010d\u0107\u017e][a-z\u0161\u0111\u010d\u0107\u017e]{2,})*\s\d+[A-Z]?(\/\d+)*$/;
$("#address").blur(k);$("#btnOrder").click(function(){const a=submitForm([k],"orderForm");a&&$(this).addClass("disabled");return a})});
